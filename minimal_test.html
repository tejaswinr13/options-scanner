<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimal Options Scanner Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h1>Minimal Options Scanner Test</h1>
        
        <div class="row mb-3">
            <div class="col-md-6">
                <input type="text" id="symbols" class="form-control" value="PLTR" placeholder="Enter symbols">
            </div>
            <div class="col-md-3">
                <input type="number" id="volume_threshold" class="form-control" value="100">
            </div>
            <div class="col-md-3">
                <button id="scanBtn" class="btn btn-primary">Start Scan</button>
            </div>
        </div>
        
        <div id="status" class="alert alert-info" style="display: none;"></div>
        <div id="results" style="display: none;"></div>
    </div>

    <script>
        console.log('Script starting...');
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded');
            
            const scanBtn = document.getElementById('scanBtn');
            const symbolsInput = document.getElementById('symbols');
            const thresholdInput = document.getElementById('volume_threshold');
            const statusDiv = document.getElementById('status');
            const resultsDiv = document.getElementById('results');
            
            console.log('Elements found:', {
                scanBtn: !!scanBtn,
                symbolsInput: !!symbolsInput,
                thresholdInput: !!thresholdInput,
                statusDiv: !!statusDiv,
                resultsDiv: !!resultsDiv
            });
            
            if (scanBtn) {
                scanBtn.addEventListener('click', function() {
                    console.log('Scan button clicked!');
                    
                    const symbols = symbolsInput.value.trim();
                    const threshold = thresholdInput.value;
                    
                    console.log('Values:', { symbols, threshold });
                    
                    // Show status
                    statusDiv.style.display = 'block';
                    statusDiv.textContent = 'Starting scan...';
                    scanBtn.disabled = true;
                    scanBtn.textContent = 'Scanning...';
                    
                    // Make API call
                    fetch('/scan', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            symbols: symbols,
                            volume_threshold: parseInt(threshold)
                        })
                    })
                    .then(response => {
                        console.log('Response status:', response.status);
                        return response.json();
                    })
                    .then(data => {
                        console.log('Response data:', data);
                        statusDiv.textContent = 'Scan initiated successfully!';
                        statusDiv.className = 'alert alert-success';
                        
                        // Reset button
                        scanBtn.disabled = false;
                        scanBtn.textContent = 'Start Scan';
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        statusDiv.textContent = 'Error: ' + error.message;
                        statusDiv.className = 'alert alert-danger';
                        
                        // Reset button
                        scanBtn.disabled = false;
                        scanBtn.textContent = 'Start Scan';
                    });
                });
            } else {
                console.error('Scan button not found!');
            }
        });
    </script>
</body>
</html>
